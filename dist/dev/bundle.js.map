{"version":3,"file":"bundle.js.map","sources":["../Users/zhengqiguang/Work/github/QV/src/common/selector.js","../Users/zhengqiguang/Work/github/QV/src/dsl/index.js","../Users/zhengqiguang/Work/github/QV/src/compiler/ast/parse-tag.js","../Users/zhengqiguang/Work/github/QV/src/compiler/ast/parse.js","../Users/zhengqiguang/Work/github/QV/src/compiler/ast/index.js","../Users/zhengqiguang/Work/github/QV/src/compiler/compiler-helper.js","../Users/zhengqiguang/Work/github/QV/src/core/render.js","../Users/zhengqiguang/Work/github/QV/src/compiler/compiler-v2.js","../Users/zhengqiguang/Work/github/QV/src/core/event-loop.js","../Users/zhengqiguang/Work/github/QV/src/core/node.js","../Users/zhengqiguang/Work/github/QV/src/core/watcher.js","../Users/zhengqiguang/Work/github/QV/src/core/data.js","../Users/zhengqiguang/Work/github/QV/src/core/core.js","../Users/zhengqiguang/Work/github/QV/src/index.js"],"sourcesContent":["/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nexport default {\n    s(selector = \"\"){ //单个\n        return document.querySelector(selector);\n    },\n    m(selector = \"\"){// 集合\n        return document.querySelectorAll(selector);\n    },\n    id(id = \"\"){\n        return document.getElementById(id);\n    }\n\n}\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\nvar dsl_prefix = \"dsl-\";\n\nconst dslMap = {\n    \"dsl-if\": 1,\n    \"dsl-for\": 1,\n    \"dsl-html\": 1\n};\n\nclass DSL {\n    constructor() {\n        this.initAll();\n    }\n\n    initAll() {\n    }\n\n    get dslMap() {\n        return dslMap;\n    }\n}\n\n\nexport default new DSL();\n","var attrRE = /([:\\w-]+)|['\"]{1}([^'\"]*)['\"]{1}/g;\n\n// create optimized lookup object for\n// void elements as listed here:\n// http://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements\n\nimport dsl from \"../../dsl/index\";\n\nvar lookup = (Object.create) ? Object.create(null) : {};\nlookup.area = true;\nlookup.base = true;\nlookup.br = true;\nlookup.col = true;\nlookup.embed = true;\nlookup.hr = true;\nlookup.img = true;\nlookup.input = true;\nlookup.keygen = true;\nlookup.link = true;\nlookup.menuitem = true;\nlookup.meta = true;\nlookup.param = true;\nlookup.source = true;\nlookup.track = true;\nlookup.wbr = true;\n\nexport default function (tag) {\n    var i = 0;\n    var key;\n    var res = {\n        type: 'tag',\n        name: '',\n        voidElement: false,\n        attrs: {},\n        children: [],\n        dsl: []\n    };\n\n    tag.replace(attrRE, function (match) {\n\n        if (dsl.dslMap[match]) {\n           res.dsl.push(match);\n        }\n\n        if (i % 2) {\n            key = match;\n        } else {\n            if (i === 0) {\n                if (lookup[match] || tag.charAt(tag.length - 2) === '/') {\n                    res.voidElement = true;\n                }\n                res.name = match;\n            } else {\n                res.attrs[key] = match.replace(/['\"]/g, '');\n            }\n        }\n        i++;\n    });\n\n    return res;\n};","/**\n * Created by zhengqiguang on 2017/6/15.\n */\nvar tagRE = /<(?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])+>/g;\n\nimport parseTag from \"./parse-tag\";\n\nvar empty = Object.create ? Object.create(null) : {};\n\nexport default function (html, options) {\n    options || (options = {});\n    options.components || (options.components = empty);\n    var result = [];\n    var current;\n    var level = -1;\n    var arr = [];\n    var byTag = {};\n    var inComponent = false;\n\n    html.replace(tagRE, function (tag, index) {\n        if (inComponent) {\n            if (tag !== ('</' + current.name + '>')) {\n                return;\n            } else {\n                inComponent = false;\n            }\n        }\n        var isOpen = tag.charAt(1) !== '/';\n        var start = index + tag.length;\n        var nextChar = html.charAt(start);\n        var parent;\n\n        if (isOpen) {\n            level++;\n\n            current = parseTag(tag);\n            if (current.type === 'tag' && options.components[current.name]) {\n                current.type = 'component';\n                inComponent = true;\n            }\n\n            if (!current.voidElement && !inComponent && nextChar && nextChar !== '<') {\n                current.children.push({\n                    type: 'text',\n                    content: html.slice(start, html.indexOf('<', start)),\n                    parent: current\n                });\n            }\n\n            byTag[current.tagName] = current;\n\n            // if we're at root, push new base node\n            if (level === 0) {\n                result.push(current);\n            }\n\n            parent = arr[level - 1];\n\n            if (parent) {\n                current.prev = parent.children[parent.children.length - 1]\n                parent.children[parent.children.length - 1].next = current;\n                parent.children.push(current);\n                current.parent = parent;\n            }\n\n            arr[level] = current;\n        }\n\n        if (!isOpen || current.voidElement) {\n            level--;\n            if (!inComponent && nextChar !== '<' && nextChar) {\n                // trailing text node\n                arr[level].children.push({\n                    type: 'text',\n                    content: html.slice(start, html.indexOf('<', start)),\n                    parent: arr[level]\n                });\n            }\n        }\n    });\n\n    return result;\n};","/**\n * Created by zhengqiguang on 2017/6/15.\n * 修改 by  https://github.com/HenrikJoreteg/html-parse-stringify/\n */\nimport parse from \"./parse\";\nimport stringify from \"./stringify\";\n\nexport {parse, stringify};\n\n","/**\n * Created by zhengqiguang on 2017/6/21.\n */\n\nconst compiler_helper = {\n    _c(tagName, attrs = {}, children = []){\n\n        let $t = document.createElement(tagName);\n\n        for (let key in attrs) {\n            $t.setAttribute(key, attrs[key]);\n        }\n\n        for (let i = 0, n; n = children[i]; i++) {\n            $t.appendChild(n.value);\n        }\n\n        return {\n            type: \"tag\",\n            value: $t\n        };\n    },\n    getItemData(data, itemNameSet){\n\n        if (itemNameSet.length == 1) {\n            return data[itemNameSet[0]];\n        } else {\n            return this.getItemData(data[itemNameSet.shift()], itemNameSet);\n        }\n\n    },\n    _i(data, itemName, renderIfFn){\n\n        if (this.getItemData(data, itemName)) {\n            return renderIfFn();\n        } else {\n            return {\n                type: \"fragment\",\n                value: document.createDocumentFragment()\n            }\n        }\n    },\n    _f(data, itemName, keyName, renderEachFn){\n\n        let $t = document.createDocumentFragment();\n\n        let $o = this.getItemData(data, itemName);\n\n        for (let item in $o) {\n            data[keyName] = $o[item];\n\n            $t.appendChild(renderEachFn(data).value);\n        }\n\n        delete data[keyName];\n\n        return {\n            type: \"fragment\",\n            value: $t\n        };\n\n    },\n\n    _h(data, htmlItemName, tagName, attrs = {}){\n\n        let $t = this._c(tagName, attrs).value;\n        $t.innerHTML = this.getItemData(data, htmlItemName);\n        return {\n            type: \"tag\",\n            value: $t\n        }\n\n    },\n\n    _t(fn, data){\n\n        let temp = fn(data);\n\n        return {\n            type: \"text\",\n            value: document.createTextNode(temp)\n        };\n    },\n\n    generaltplFn($ast){\n\n        let linkArgs = [];\n        let $temp = this.generalNode($ast, linkArgs),\n\n            $tempFn = `with(that){return ${$temp}}`;\n        let tplFn = new Function(\"that\", `${$tempFn}`);\n\n        return {\n            tplFn: tplFn,\n            linkArgs: linkArgs\n        };\n\n    },\n    generalNode($node, linkArgs){\n\n        if ($node.dsl && $node.dsl.length) { //存在 dsl\n            //dsl 优先级 if > for > html\n            let $sdlTemp = \"\";\n            let dslIndex;\n            if ((dslIndex = $node.dsl.indexOf(\"dsl-if\")) !== -1) { //先判断 if 语句\n                let itemName = $node.attrs[\"dsl-if\"];//现在只判断了值，没有进行表达式判断\n\n                linkArgs.push(itemName);\n\n                $node.dsl.splice(dslIndex, 1);\n                delete $node.attrs[\"dsl-if\"];\n\n\n                return `_i(data,${this.formatParam(itemName)},function(){\n                    return ${this.generalNode($node, linkArgs)} \n                })`\n\n\n            } else if ((dslIndex = $node.dsl.indexOf(\"dsl-for\")) !== -1) { //\n                let reg = /([\\w\\W]+) in ([\\w\\W]+)/,\n                    result = $node.attrs[\"dsl-for\"].match(reg);\n\n\n                linkArgs.push(result[2]);\n\n                $node.dsl.splice(dslIndex, 1);\n                delete $node.attrs[\"dsl-for\"];\n\n                return `_f(data,${this.formatParam(result[2])},'${result[1]}',function(data){\n                    return ${this.generalNode($node, linkArgs)} ;\n                })`\n\n            } else if ((dslIndex = $node.dsl.indexOf(\"dsl-html\")) !== -1) {\n                //有 html 模板的时候，忽略其中的节点，因为会被替换\n                let itemName = $node.attrs[\"dsl-html\"];//现在只判断了值，没有进行表达式判断\n\n                linkArgs.push(itemName);\n\n                $node.dsl.splice(dslIndex, 1);\n                delete $node.attrs[\"dsl-html\"];\n\n                return `_h(data,${this.formatParam(itemName)},'${$node.name}', ${JSON.stringify($node.attrs)})`;\n\n\n            }\n\n\n        } else if ($node.type === \"tag\") {\n            return `_c('${$node.name}', ${JSON.stringify($node.attrs)},[${$node.children.map(item => {\n                return this.generalNode(item, linkArgs)\n            })}])`\n\n        } else if ($node.type === \"text\") {\n            $node.content = $node.content.replace(/\\n/g, \"\");\n            let text = $node.content.trim();\n\n            let patt = /{{[ \\t]*([\\w\\W]*?)[ \\t]*}}/g;\n\n            let result = \"\",\n                temp = \"\",\n                cursor = 0;\n\n            while ((result = patt.exec(text)) !== null) {\n                let $temp1 = text.slice(cursor, result.index); //模板前面\n                cursor += $temp1.length;\n\n                temp += this.wrapStaticBlock($temp1);\n\n                temp += this.wrapDynamicBlock(result);\n\n                linkArgs.push(result[1]);\n\n                cursor += result[0].length;\n            }\n\n\n            temp += this.wrapStaticBlock(text.slice(cursor, text.length));\n\n            let fn = this.gTplFn(temp);\n\n            return `_t(${fn.toString()},data)`\n        }\n\n\n    },\n    wrapStaticBlock(str) {\n\n        return \"\\'\" + str + \"\\'\";\n\n    },\n    wrapDynamicBlock (result) {\n\n        return \" + data.\" + result[1] + \" + \"\n    },\n    gTplFn: function (str) {\n\n        let $t = \" return \" + str;\n\n        $t = $t.replace(/\\n/g, \"\");\n\n        let $tempFn = new Function(\"data\", $t);\n\n        return $tempFn;\n\n    },\n    formatParam(str){\n        let $s = str.split(\".\");\n        return JSON.stringify($s);\n    }\n\n}\n\nexport default compiler_helper;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\nimport compiler_helper from \"../compiler/compiler-helper\";\n\nconst render = {\n\n    mount($node, $data){\n\n        compiler_helper.data = $data;\n\n        let $newDom = this.generalDom($node.$tplfn(compiler_helper));\n\n        this.replaceNode($newDom, $node);\n\n    },\n\n    generalDom(domStr){\n\n        if (domStr instanceof Object) {\n            return domStr.value;\n        }\n\n        var $temp = document.createElement(\"div\");\n        $temp.innerHTML = domStr.trim(); //不然会有多余的空格等东西\n        return $temp.childNodes[0];\n    },\n\n    replaceNode(newDom, node){\n        let $el = node.$el;\n\n        $el.parentNode.replaceChild(newDom, $el);\n\n        node.$el = newDom;\n    }\n\n\n}\n\n\nexport default render;","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\nimport {parse as htmlParse, stringify as htmlStringify} from \"./ast/index\";\n\nimport Render from \"../core/render\";\n\nimport compiler_helper from \"./compiler-helper\";\n\nclass Compiler {\n\n\n    constructor(tpl) {\n        this.$tpl = Render.generalDom(tpl);\n        this.tpl = this.$tpl.outerHTML;\n        this.$ast = htmlParse(tpl);\n\n        this.init(compiler_helper.generaltplFn(this.$ast[0]));\n\n    }\n\n\n    init({tplFn, linkArgs}) {\n        this.tplFn = tplFn;\n        this.linkArgs = linkArgs;\n    }\n\n}\n\n\nexport default Compiler;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\nlet EventLoop = {\n    d_o(fn){\n        let p = Promise.resolve();\n        p.then(fn).catch((e) => {\n            console.log(e);\n        });\n    }\n\n}\n\nexport default EventLoop;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nimport selector from  \"../common/selector\";\n\nimport Compiler from \"../compiler/compiler-v2\";\n\nimport Render  from \"./render\";\n\nimport EventLoop from \"./event-loop\";\n\n\nclass Node {\n\n    constructor({el, template, data}) {\n        this.$data = data;\n        this.el = el;\n        this.template = template;\n        this.$el = selector.s(this.el);\n\n        let $t = selector.s(this.template);\n        if ($t) {\n            this.$template = $t.innerHTML.trim();\n        } else {\n            //error\n        }\n        this.$compiler = new Compiler(this.$template);\n\n        this.$args = this.$compiler.linkArgs;\n        this.$tplfn = this.$compiler.tplFn;\n    }\n\n    update() {\n        EventLoop.d_o(Render.mount.bind(Render, this, this.$data));\n    }\n\n}\n\nexport default Node;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nclass Watcher {\n    constructor(data) {\n        this.$data = data;\n        this.mountWatcher();\n\n    }\n\n    mountWatcher() {\n\n        let od = this.$data[\"_od_\"];\n\n        for (let key in this.$data) {\n\n            (function (key) {\n\n                let timeoutHandler = null;\n\n                if (key !== \"_od_\" && !od[key].mounted) {\n                    if (!od[key]) {\n                        throw new Error(`data:${key} is init `);\n                    }\n                    Object.defineProperty(this.$data, key, {\n                        get () {\n                            return od[key].value;\n                        },\n                        set(value) {\n                            clearTimeout(timeoutHandler);\n                            setTimeout(() => {\n                                if (value !== od[key].value) {\n                                    var $n = od[key].linkNodes;\n                                    od[key].value = value;\n                                    for (var i = 0, n; n = $n[i]; i++) {\n                                        n.update();\n                                    }\n                                }\n                            }, 1000 / 60);//一帧节流\n\n                        }\n                    });\n                    od[key].mounted = true;\n                }\n            }.bind(this))(key);\n\n        }\n    }\n\n    linkNode($node) {\n\n\n        for (let i = 0, n; n = $node.$args[i]; i++) {\n            if (this.$data[n] !== undefined &&\n                this.$data[\"_od_\"][n] !== undefined &&\n                this.$data[\"_od_\"][n].linkNodes.indexOf($node) === -1) {\n                this.$data[\"_od_\"][n].linkNodes.push($node);\n            }\n        }\n    }\n\n\n    updateData() {\n\n\n    }\n\n\n}\n\n\nexport default Watcher;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nconst helper = {\n    insertOD($targetData, $data){\n\n        !$targetData && ($targetData = {});\n\n        for (var key in $data) {\n            $targetData[key] = {\n                value: $data[key],\n                linkNodes: [],\n                mounted: false\n            }\n        }\n\n        return $targetData;\n\n    }\n\n\n}\n\nclass Data {\n\n    static formatData(data = {}) {\n        data[\"_od_\"] = helper.insertOD(data[\"_od_\"], data);\n        return data;\n    }\n\n\n}\n\nexport default Data;\n","/**\n * Created by zhengqiguang on 2017/6/14.\n */\n\nimport Node from \"./node\";\nimport Watcher from \"./watcher\";\nimport Data from \"./data\";\nimport render from \"./render\";\n\nclass QV {\n    constructor(opt = {}) {\n        this._$opt = opt;\n\n        this.formatOption(opt);\n\n        this.mountRoot();\n\n    }\n\n    formatOption(opt) {\n\n        this.$data = Data.formatData(opt.data);\n\n        this.$root = new Node(opt);\n\n        this.$watcher = new Watcher(this.$data);\n\n        this.$watcher.linkNode(this.$root);\n\n    }\n\n    mountRoot() {\n        render.mount(this.$root, this.$data);\n    }\n\n\n}\n\n\nexport  default QV;\n","/**\n * Created by zhengqiguang on 2017/6/14.\n */\n\n\nimport Core from \"./core/core\";\n\n\n\nexport default Core;\n"],"names":["selector","document","querySelector","querySelectorAll","id","getElementById","dslMap","DSL","initAll","attrRE","lookup","Object","create","area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","tag","i","key","res","replace","match","dsl","push","charAt","length","voidElement","name","attrs","tagRE","empty","html","options","components","result","current","level","arr","byTag","inComponent","index","isOpen","start","nextChar","parent","parseTag","type","children","slice","indexOf","tagName","prev","next","compiler_helper","$t","createElement","setAttribute","n","appendChild","value","data","itemNameSet","getItemData","shift","itemName","renderIfFn","createDocumentFragment","keyName","renderEachFn","$o","item","htmlItemName","_c","innerHTML","fn","temp","createTextNode","$ast","linkArgs","$temp","generalNode","$tempFn","tplFn","Function","$node","$sdlTemp","dslIndex","splice","formatParam","reg","JSON","stringify","map","content","text","trim","patt","cursor","exec","$temp1","wrapStaticBlock","wrapDynamicBlock","gTplFn","toString","str","$s","split","render","$data","$newDom","generalDom","$tplfn","replaceNode","domStr","childNodes","newDom","node","$el","parentNode","replaceChild","Compiler","tpl","$tpl","Render","outerHTML","htmlParse","init","generaltplFn","EventLoop","p","Promise","resolve","then","catch","e","log","Node","el","template","s","$template","$compiler","$args","d_o","mount","bind","Watcher","mountWatcher","od","timeoutHandler","mounted","Error","defineProperty","$n","linkNodes","update","undefined","helper","$targetData","Data","insertOD","QV","opt","_$opt","formatOption","mountRoot","formatData","$root","$watcher","linkNode"],"mappings":";;;;;;AAAA;;;;AAIA,eAAe;KAAA,eACK;YAAdA,QAAc,uEAAH,EAAG;;eACLC,SAASC,aAAT,CAAuBF,QAAvB,CAAP;KAFO;KAAA,eAIK;YAAdA,QAAc,uEAAH,EAAG;;eACLC,SAASE,gBAAT,CAA0BH,QAA1B,CAAP;KALO;MAAA,gBAOA;YAARI,GAAQ,uEAAH,EAAG;;eACAH,SAASI,cAAT,CAAwBD,GAAxB,CAAP;;CARR;;;;;;;;;;;;;;;;;;;;;;;;;;ACJA;;;;AAKA,AAEA,IAAME,SAAS;cACD,CADC;eAEA,CAFA;gBAGC;CAHhB;;IAMMC;mBACY;;;aACLC,OAAL;;;;;kCAGM;;;+BAGG;mBACFF,MAAP;;;;;;AAKR,UAAe,IAAIC,GAAJ,EAAf;;AC3BA,IAAIE,SAAS,mCAAb;;;;;;AAMA,AAEA,IAAIC,SAAUC,OAAOC,MAAR,GAAkBD,OAAOC,MAAP,CAAc,IAAd,CAAlB,GAAwC,EAArD;AACAF,OAAOG,IAAP,GAAc,IAAd;AACAH,OAAOI,IAAP,GAAc,IAAd;AACAJ,OAAOK,EAAP,GAAY,IAAZ;AACAL,OAAOM,GAAP,GAAa,IAAb;AACAN,OAAOO,KAAP,GAAe,IAAf;AACAP,OAAOQ,EAAP,GAAY,IAAZ;AACAR,OAAOS,GAAP,GAAa,IAAb;AACAT,OAAOU,KAAP,GAAe,IAAf;AACAV,OAAOW,MAAP,GAAgB,IAAhB;AACAX,OAAOY,IAAP,GAAc,IAAd;AACAZ,OAAOa,QAAP,GAAkB,IAAlB;AACAb,OAAOc,IAAP,GAAc,IAAd;AACAd,OAAOe,KAAP,GAAe,IAAf;AACAf,OAAOgB,MAAP,GAAgB,IAAhB;AACAhB,OAAOiB,KAAP,GAAe,IAAf;AACAjB,OAAOkB,GAAP,GAAa,IAAb;;AAEA,eAAe,UAAUC,GAAV,EAAe;QACtBC,IAAI,CAAR;QACIC,GAAJ;QACIC,MAAM;cACA,KADA;cAEA,EAFA;qBAGO,KAHP;eAIC,EAJD;kBAKI,EALJ;aAMD;KANT;;QASIC,OAAJ,CAAYxB,MAAZ,EAAoB,UAAUyB,KAAV,EAAiB;;YAE7BC,IAAI7B,MAAJ,CAAW4B,KAAX,CAAJ,EAAuB;gBAChBC,GAAJ,CAAQC,IAAR,CAAaF,KAAb;;;YAGCJ,IAAI,CAAR,EAAW;kBACDI,KAAN;SADJ,MAEO;gBACCJ,MAAM,CAAV,EAAa;oBACLpB,OAAOwB,KAAP,KAAiBL,IAAIQ,MAAJ,CAAWR,IAAIS,MAAJ,GAAa,CAAxB,MAA+B,GAApD,EAAyD;wBACjDC,WAAJ,GAAkB,IAAlB;;oBAEAC,IAAJ,GAAWN,KAAX;aAJJ,MAKO;oBACCO,KAAJ,CAAUV,GAAV,IAAiBG,MAAMD,OAAN,CAAc,OAAd,EAAuB,EAAvB,CAAjB;;;;KAfZ;;WAqBOD,GAAP;;;AC3DJ;;;AAGA,IAAIU,QAAQ,0CAAZ;;AAEA,AAEA,IAAIC,QAAQhC,OAAOC,MAAP,GAAgBD,OAAOC,MAAP,CAAc,IAAd,CAAhB,GAAsC,EAAlD;;AAEA,gBAAe,UAAUgC,IAAV,EAAgBC,OAAhB,EAAyB;gBACxBA,UAAU,EAAtB;YACQC,UAAR,KAAuBD,QAAQC,UAAR,GAAqBH,KAA5C;QACII,SAAS,EAAb;QACIC,OAAJ;QACIC,QAAQ,CAAC,CAAb;QACIC,MAAM,EAAV;QACIC,QAAQ,EAAZ;QACIC,cAAc,KAAlB;;SAEKnB,OAAL,CAAaS,KAAb,EAAoB,UAAUb,GAAV,EAAewB,KAAf,EAAsB;YAClCD,WAAJ,EAAiB;gBACTvB,QAAS,OAAOmB,QAAQR,IAAf,GAAsB,GAAnC,EAAyC;;aAAzC,MAEO;8BACW,KAAd;;;YAGJc,SAASzB,IAAIQ,MAAJ,CAAW,CAAX,MAAkB,GAA/B;YACIkB,QAAQF,QAAQxB,IAAIS,MAAxB;YACIkB,WAAWZ,KAAKP,MAAL,CAAYkB,KAAZ,CAAf;YACIE,MAAJ;;YAEIH,MAAJ,EAAY;;;sBAGEI,SAAS7B,GAAT,CAAV;gBACImB,QAAQW,IAAR,KAAiB,KAAjB,IAA0Bd,QAAQC,UAAR,CAAmBE,QAAQR,IAA3B,CAA9B,EAAgE;wBACpDmB,IAAR,GAAe,WAAf;8BACc,IAAd;;;gBAGA,CAACX,QAAQT,WAAT,IAAwB,CAACa,WAAzB,IAAwCI,QAAxC,IAAoDA,aAAa,GAArE,EAA0E;wBAC9DI,QAAR,CAAiBxB,IAAjB,CAAsB;0BACZ,MADY;6BAETQ,KAAKiB,KAAL,CAAWN,KAAX,EAAkBX,KAAKkB,OAAL,CAAa,GAAb,EAAkBP,KAAlB,CAAlB,CAFS;4BAGVP;iBAHZ;;;kBAOEA,QAAQe,OAAd,IAAyBf,OAAzB;;;gBAGIC,UAAU,CAAd,EAAiB;uBACNb,IAAP,CAAYY,OAAZ;;;qBAGKE,IAAID,QAAQ,CAAZ,CAAT;;gBAEIQ,MAAJ,EAAY;wBACAO,IAAR,GAAeP,OAAOG,QAAP,CAAgBH,OAAOG,QAAP,CAAgBtB,MAAhB,GAAyB,CAAzC,CAAf;uBACOsB,QAAP,CAAgBH,OAAOG,QAAP,CAAgBtB,MAAhB,GAAyB,CAAzC,EAA4C2B,IAA5C,GAAmDjB,OAAnD;uBACOY,QAAP,CAAgBxB,IAAhB,CAAqBY,OAArB;wBACQS,MAAR,GAAiBA,MAAjB;;;gBAGAR,KAAJ,IAAaD,OAAb;;;YAGA,CAACM,MAAD,IAAWN,QAAQT,WAAvB,EAAoC;;gBAE5B,CAACa,WAAD,IAAgBI,aAAa,GAA7B,IAAoCA,QAAxC,EAAkD;;oBAE1CP,KAAJ,EAAWW,QAAX,CAAoBxB,IAApB,CAAyB;0BACf,MADe;6BAEZQ,KAAKiB,KAAL,CAAWN,KAAX,EAAkBX,KAAKkB,OAAL,CAAa,GAAb,EAAkBP,KAAlB,CAAlB,CAFY;4BAGbL,IAAID,KAAJ;iBAHZ;;;KArDZ;;WA8DOF,MAAP;;;ACjFJ;;;;;ACAA;;;;AAIA,IAAMmB,kBAAkB;MAAA,cACjBH,OADiB,EACkB;YAA1BtB,KAA0B,uEAAlB,EAAkB;YAAdmB,QAAc,uEAAH,EAAG;;;YAE9BO,KAAKlE,SAASmE,aAAT,CAAuBL,OAAvB,CAAT;;aAEK,IAAIhC,GAAT,IAAgBU,KAAhB,EAAuB;eAChB4B,YAAH,CAAgBtC,GAAhB,EAAqBU,MAAMV,GAAN,CAArB;;;aAGC,IAAID,IAAI,CAAR,EAAWwC,CAAhB,EAAmBA,IAAIV,SAAS9B,CAAT,CAAvB,EAAoCA,GAApC,EAAyC;eAClCyC,WAAH,CAAeD,EAAEE,KAAjB;;;eAGG;kBACG,KADH;mBAEIL;SAFX;KAbgB;eAAA,uBAkBRM,IAlBQ,EAkBFC,WAlBE,EAkBU;;YAEtBA,YAAYpC,MAAZ,IAAsB,CAA1B,EAA6B;mBAClBmC,KAAKC,YAAY,CAAZ,CAAL,CAAP;SADJ,MAEO;mBACI,KAAKC,WAAL,CAAiBF,KAAKC,YAAYE,KAAZ,EAAL,CAAjB,EAA4CF,WAA5C,CAAP;;KAvBY;MAAA,cA2BjBD,IA3BiB,EA2BXI,QA3BW,EA2BDC,UA3BC,EA2BU;;YAEtB,KAAKH,WAAL,CAAiBF,IAAjB,EAAuBI,QAAvB,CAAJ,EAAsC;mBAC3BC,YAAP;SADJ,MAEO;mBACI;sBACG,UADH;uBAEI7E,SAAS8E,sBAAT;aAFX;;KAhCY;MAAA,cAsCjBN,IAtCiB,EAsCXI,QAtCW,EAsCDG,OAtCC,EAsCQC,YAtCR,EAsCqB;;YAEjCd,KAAKlE,SAAS8E,sBAAT,EAAT;;YAEIG,KAAK,KAAKP,WAAL,CAAiBF,IAAjB,EAAuBI,QAAvB,CAAT;;aAEK,IAAIM,IAAT,IAAiBD,EAAjB,EAAqB;iBACZF,OAAL,IAAgBE,GAAGC,IAAH,CAAhB;;eAEGZ,WAAH,CAAeU,aAAaR,IAAb,EAAmBD,KAAlC;;;eAGGC,KAAKO,OAAL,CAAP;;eAEO;kBACG,UADH;mBAEIb;SAFX;KApDgB;MAAA,cA2DjBM,IA3DiB,EA2DXW,YA3DW,EA2DGrB,OA3DH,EA2DuB;YAAXtB,KAAW,uEAAH,EAAG;;;YAEnC0B,KAAK,KAAKkB,EAAL,CAAQtB,OAAR,EAAiBtB,KAAjB,EAAwB+B,KAAjC;WACGc,SAAH,GAAe,KAAKX,WAAL,CAAiBF,IAAjB,EAAuBW,YAAvB,CAAf;eACO;kBACG,KADH;mBAEIjB;SAFX;KA/DgB;MAAA,cAsEjBoB,EAtEiB,EAsEbd,IAtEa,EAsER;;YAEJe,OAAOD,GAAGd,IAAH,CAAX;;eAEO;kBACG,MADH;mBAEIxE,SAASwF,cAAT,CAAwBD,IAAxB;SAFX;KA1EgB;gBAAA,wBAgFPE,IAhFO,EAgFF;;YAEVC,WAAW,EAAf;YACIC,QAAQ,KAAKC,WAAL,CAAiBH,IAAjB,EAAuBC,QAAvB,CAAZ;YAEIG,iCAA+BF,KAA/B,MAFJ;YAGIG,QAAQ,IAAIC,QAAJ,CAAa,MAAb,OAAwBF,OAAxB,CAAZ;;eAEO;mBACIC,KADJ;sBAEOJ;SAFd;KAxFgB;eAAA,uBA8FRM,KA9FQ,EA8FDN,QA9FC,EA8FQ;;;YAEpBM,MAAM9D,GAAN,IAAa8D,MAAM9D,GAAN,CAAUG,MAA3B,EAAmC;;;gBAE3B4D,WAAW,EAAf;gBACIC,iBAAJ;gBACI,CAACA,WAAWF,MAAM9D,GAAN,CAAU2B,OAAV,CAAkB,QAAlB,CAAZ,MAA6C,CAAC,CAAlD,EAAqD;;oBAC7Ce,WAAWoB,MAAMxD,KAAN,CAAY,QAAZ,CAAf,CADiD;;yBAGxCL,IAAT,CAAcyC,QAAd;;sBAEM1C,GAAN,CAAUiE,MAAV,CAAiBD,QAAjB,EAA2B,CAA3B;uBACOF,MAAMxD,KAAN,CAAY,QAAZ,CAAP;;oCAGkB,KAAK4D,WAAL,CAAiBxB,QAAjB,CAAlB,iDACa,KAAKgB,WAAL,CAAiBI,KAAjB,EAAwBN,QAAxB,CADb;aATJ,MAcO,IAAI,CAACQ,WAAWF,MAAM9D,GAAN,CAAU2B,OAAV,CAAkB,SAAlB,CAAZ,MAA8C,CAAC,CAAnD,EAAsD;;oBACrDwC,MAAM,wBAAV;oBACIvD,SAASkD,MAAMxD,KAAN,CAAY,SAAZ,EAAuBP,KAAvB,CAA6BoE,GAA7B,CADb;;yBAISlE,IAAT,CAAcW,OAAO,CAAP,CAAd;;sBAEMZ,GAAN,CAAUiE,MAAV,CAAiBD,QAAjB,EAA2B,CAA3B;uBACOF,MAAMxD,KAAN,CAAY,SAAZ,CAAP;;oCAEkB,KAAK4D,WAAL,CAAiBtD,OAAO,CAAP,CAAjB,CAAlB,UAAkDA,OAAO,CAAP,CAAlD,sDACa,KAAK8C,WAAL,CAAiBI,KAAjB,EAAwBN,QAAxB,CADb;aAVG,MAcA,IAAI,CAACQ,WAAWF,MAAM9D,GAAN,CAAU2B,OAAV,CAAkB,UAAlB,CAAZ,MAA+C,CAAC,CAApD,EAAuD;;oBAEtDe,YAAWoB,MAAMxD,KAAN,CAAY,UAAZ,CAAf,CAF0D;;yBAIjDL,IAAT,CAAcyC,SAAd;;sBAEM1C,GAAN,CAAUiE,MAAV,CAAiBD,QAAjB,EAA2B,CAA3B;uBACOF,MAAMxD,KAAN,CAAY,UAAZ,CAAP;;oCAEkB,KAAK4D,WAAL,CAAiBxB,SAAjB,CAAlB,UAAiDoB,MAAMzD,IAAvD,WAAiE+D,KAAKC,SAAL,CAAeP,MAAMxD,KAArB,CAAjE;;SAzCR,MA+CO,IAAIwD,MAAMtC,IAAN,KAAe,KAAnB,EAA0B;4BACfsC,MAAMzD,IAApB,WAA8B+D,KAAKC,SAAL,CAAeP,MAAMxD,KAArB,CAA9B,UAA8DwD,MAAMrC,QAAN,CAAe6C,GAAf,CAAmB,gBAAQ;uBAC9E,MAAKZ,WAAL,CAAiBV,IAAjB,EAAuBQ,QAAvB,CAAP;aAD0D,CAA9D;SADG,MAKA,IAAIM,MAAMtC,IAAN,KAAe,MAAnB,EAA2B;kBACxB+C,OAAN,GAAgBT,MAAMS,OAAN,CAAczE,OAAd,CAAsB,KAAtB,EAA6B,EAA7B,CAAhB;gBACI0E,OAAOV,MAAMS,OAAN,CAAcE,IAAd,EAAX;;gBAEIC,OAAO,6BAAX;;gBAEI9D,UAAS,EAAb;gBACIyC,OAAO,EADX;gBAEIsB,SAAS,CAFb;;mBAIO,CAAC/D,UAAS8D,KAAKE,IAAL,CAAUJ,IAAV,CAAV,MAA+B,IAAtC,EAA4C;oBACpCK,SAASL,KAAK9C,KAAL,CAAWiD,MAAX,EAAmB/D,QAAOM,KAA1B,CAAb,CADwC;0BAE9B2D,OAAO1E,MAAjB;;wBAEQ,KAAK2E,eAAL,CAAqBD,MAArB,CAAR;;wBAEQ,KAAKE,gBAAL,CAAsBnE,OAAtB,CAAR;;yBAESX,IAAT,CAAcW,QAAO,CAAP,CAAd;;0BAEUA,QAAO,CAAP,EAAUT,MAApB;;;oBAII,KAAK2E,eAAL,CAAqBN,KAAK9C,KAAL,CAAWiD,MAAX,EAAmBH,KAAKrE,MAAxB,CAArB,CAAR;;gBAEIiD,KAAK,KAAK4B,MAAL,CAAY3B,IAAZ,CAAT;;2BAEaD,GAAG6B,QAAH,EAAb;;KAhLY;mBAAA,2BAqLJC,GArLI,EAqLC;;eAEV,OAAOA,GAAP,GAAa,IAApB;KAvLgB;oBAAA,4BA0LFtE,MA1LE,EA0LM;;eAEf,aAAaA,OAAO,CAAP,CAAb,GAAyB,KAAhC;KA5LgB;;YA8LZ,gBAAUsE,GAAV,EAAe;;YAEflD,KAAK,aAAakD,GAAtB;;aAEKlD,GAAGlC,OAAH,CAAW,KAAX,EAAkB,EAAlB,CAAL;;YAEI6D,UAAU,IAAIE,QAAJ,CAAa,MAAb,EAAqB7B,EAArB,CAAd;;eAEO2B,OAAP;KAtMgB;eAAA,uBAyMRuB,GAzMQ,EAyMJ;YACRC,KAAKD,IAAIE,KAAJ,CAAU,GAAV,CAAT;eACOhB,KAAKC,SAAL,CAAec,EAAf,CAAP;;CA3MR;;ACJA;;;;AAKA,AAEA,IAAME,SAAS;SAAA,iBAELvB,KAFK,EAEEwB,KAFF,EAEQ;;wBAEChD,IAAhB,GAAuBgD,KAAvB;;YAEIC,UAAU,KAAKC,UAAL,CAAgB1B,MAAM2B,MAAN,CAAa1D,eAAb,CAAhB,CAAd;;aAEK2D,WAAL,CAAiBH,OAAjB,EAA0BzB,KAA1B;KARO;cAAA,sBAYA6B,MAZA,EAYO;;YAEVA,kBAAkBnH,MAAtB,EAA8B;mBACnBmH,OAAOtD,KAAd;;;YAGAoB,QAAQ3F,SAASmE,aAAT,CAAuB,KAAvB,CAAZ;cACMkB,SAAN,GAAkBwC,OAAOlB,IAAP,EAAlB,CAPc;eAQPhB,MAAMmC,UAAN,CAAiB,CAAjB,CAAP;KApBO;eAAA,uBAuBCC,MAvBD,EAuBSC,IAvBT,EAuBc;YACjBC,MAAMD,KAAKC,GAAf;;YAEIC,UAAJ,CAAeC,YAAf,CAA4BJ,MAA5B,EAAoCE,GAApC;;aAEKA,GAAL,GAAWF,MAAX;;CA5BR;;ACPA;;;;AAKA,IAMMK;sBAGUC,GAAZ,EAAiB;;;aACRC,IAAL,GAAYC,OAAOb,UAAP,CAAkBW,GAAlB,CAAZ;aACKA,GAAL,GAAW,KAAKC,IAAL,CAAUE,SAArB;aACK/C,IAAL,GAAYgD,UAAUJ,GAAV,CAAZ;;aAEKK,IAAL,CAAUzE,gBAAgB0E,YAAhB,CAA6B,KAAKlD,IAAL,CAAU,CAAV,CAA7B,CAAV;;;;;mCAKoB;gBAAlBK,KAAkB,QAAlBA,KAAkB;gBAAXJ,QAAW,QAAXA,QAAW;;iBACfI,KAAL,GAAaA,KAAb;iBACKJ,QAAL,GAAgBA,QAAhB;;;;;;AC1BR;;;;AAKA,IAAIkD,YAAY;OAAA,eACRtD,EADQ,EACL;YACCuD,IAAIC,QAAQC,OAAR,EAAR;UACEC,IAAF,CAAO1D,EAAP,EAAW2D,KAAX,CAAiB,UAACC,CAAD,EAAO;oBACZC,GAAR,CAAYD,CAAZ;SADJ;;CAHR;;ACLA;;;;AAIA,IASME;wBAEgC;YAArBC,EAAqB,QAArBA,EAAqB;YAAjBC,QAAiB,QAAjBA,QAAiB;YAAP9E,IAAO,QAAPA,IAAO;;;aACzBgD,KAAL,GAAahD,IAAb;aACK6E,EAAL,GAAUA,EAAV;aACKC,QAAL,GAAgBA,QAAhB;aACKrB,GAAL,GAAWlI,SAASwJ,CAAT,CAAW,KAAKF,EAAhB,CAAX;;YAEInF,KAAKnE,SAASwJ,CAAT,CAAW,KAAKD,QAAhB,CAAT;YACIpF,EAAJ,EAAQ;iBACCsF,SAAL,GAAiBtF,GAAGmB,SAAH,CAAasB,IAAb,EAAjB;SADJ,MAEO;;;aAGF8C,SAAL,GAAiB,IAAIrB,QAAJ,CAAa,KAAKoB,SAAlB,CAAjB;;aAEKE,KAAL,GAAa,KAAKD,SAAL,CAAe/D,QAA5B;aACKiC,MAAL,GAAc,KAAK8B,SAAL,CAAe3D,KAA7B;;;;;iCAGK;sBACK6D,GAAV,CAAcpB,OAAOqB,KAAP,CAAaC,IAAb,CAAkBtB,MAAlB,EAA0B,IAA1B,EAAgC,KAAKf,KAArC,CAAd;;;;;;AClCR;;;;IAIMsC;qBACUtF,IAAZ,EAAkB;;;aACTgD,KAAL,GAAahD,IAAb;aACKuF,YAAL;;;;;uCAIW;;gBAEPC,KAAK,KAAKxC,KAAL,CAAW,MAAX,CAAT;;iBAEK,IAAI1F,GAAT,IAAgB,KAAK0F,KAArB,EAA4B;;2BAEb1F,GAAV,EAAe;;wBAERmI,iBAAiB,IAArB;;wBAEInI,QAAQ,MAAR,IAAkB,CAACkI,GAAGlI,GAAH,EAAQoI,OAA/B,EAAwC;4BAChC,CAACF,GAAGlI,GAAH,CAAL,EAAc;kCACJ,IAAIqI,KAAJ,WAAkBrI,GAAlB,eAAN;;+BAEGsI,cAAP,CAAsB,KAAK5C,KAA3B,EAAkC1F,GAAlC,EAAuC;+BAAA,oBAC5B;uCACIkI,GAAGlI,GAAH,EAAQyC,KAAf;6BAF+B;+BAAA,kBAI/BA,KAJ+B,EAIxB;6CACM0F,cAAb;2CACW,YAAM;wCACT1F,UAAUyF,GAAGlI,GAAH,EAAQyC,KAAtB,EAA6B;4CACrB8F,KAAKL,GAAGlI,GAAH,EAAQwI,SAAjB;2CACGxI,GAAH,EAAQyC,KAAR,GAAgBA,KAAhB;6CACK,IAAI1C,IAAI,CAAR,EAAWwC,CAAhB,EAAmBA,IAAIgG,GAAGxI,CAAH,CAAvB,EAA8BA,GAA9B,EAAmC;8CAC7B0I,MAAF;;;iCALZ,EAQG,OAAO,EARV,EAFO;;yBAJf;2BAkBGzI,GAAH,EAAQoI,OAAR,GAAkB,IAAlB;;iBA1BP,EA4BCL,IA5BD,CA4BM,IA5BN,CAAD,CA4Bc/H,GA5Bd;;;;;iCAiCCkE,OAAO;;iBAGP,IAAInE,IAAI,CAAR,EAAWwC,CAAhB,EAAmBA,IAAI2B,MAAM0D,KAAN,CAAY7H,CAAZ,CAAvB,EAAuCA,GAAvC,EAA4C;oBACpC,KAAK2F,KAAL,CAAWnD,CAAX,MAAkBmG,SAAlB,IACA,KAAKhD,KAAL,CAAW,MAAX,EAAmBnD,CAAnB,MAA0BmG,SAD1B,IAEA,KAAKhD,KAAL,CAAW,MAAX,EAAmBnD,CAAnB,EAAsBiG,SAAtB,CAAgCzG,OAAhC,CAAwCmC,KAAxC,MAAmD,CAAC,CAFxD,EAE2D;yBAClDwB,KAAL,CAAW,MAAX,EAAmBnD,CAAnB,EAAsBiG,SAAtB,CAAgCnI,IAAhC,CAAqC6D,KAArC;;;;;;qCAMC;;;;;AC/DjB;;;;AAIA,IAAMyE,SAAS;YAAA,oBACFC,WADE,EACWlD,KADX,EACiB;;SAEvBkD,WAAD,KAAiBA,cAAc,EAA/B;;aAEK,IAAI5I,GAAT,IAAgB0F,KAAhB,EAAuB;wBACP1F,GAAZ,IAAmB;uBACR0F,MAAM1F,GAAN,CADQ;2BAEJ,EAFI;yBAGN;aAHb;;;eAOG4I,WAAP;;CAbR;;IAoBMC;;;;;;;qCAE2B;gBAAXnG,IAAW,uEAAJ,EAAI;;iBACpB,MAAL,IAAeiG,OAAOG,QAAP,CAAgBpG,KAAK,MAAL,CAAhB,EAA8BA,IAA9B,CAAf;mBACOA,IAAP;;;;;;AC5BR;;;;AAIA,IAKMqG;kBACoB;YAAVC,GAAU,uEAAJ,EAAI;;;aACbC,KAAL,GAAaD,GAAb;;aAEKE,YAAL,CAAkBF,GAAlB;;aAEKG,SAAL;;;;;qCAISH,KAAK;;iBAETtD,KAAL,GAAamD,KAAKO,UAAL,CAAgBJ,IAAItG,IAApB,CAAb;;iBAEK2G,KAAL,GAAa,IAAI/B,IAAJ,CAAS0B,GAAT,CAAb;;iBAEKM,QAAL,GAAgB,IAAItB,OAAJ,CAAY,KAAKtC,KAAjB,CAAhB;;iBAEK4D,QAAL,CAAcC,QAAd,CAAuB,KAAKF,KAA5B;;;;oCAIQ;mBACDvB,KAAP,CAAa,KAAKuB,KAAlB,EAAyB,KAAK3D,KAA9B;;;;;;AChCR;;;;;;;;;;"}