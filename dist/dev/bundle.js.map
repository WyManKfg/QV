{"version":3,"file":"bundle.js.map","sources":["../Users/zhengqiguang/Work/github/QV/src/common/selector.js","../Users/zhengqiguang/Work/github/QV/src/dsl/for.js","../Users/zhengqiguang/Work/github/QV/src/dsl/index.js","../Users/zhengqiguang/Work/github/QV/src/compiler/ast/parse-tag.js","../Users/zhengqiguang/Work/github/QV/src/compiler/ast/parse.js","../Users/zhengqiguang/Work/github/QV/src/compiler/ast/index.js","../Users/zhengqiguang/Work/github/QV/src/compiler/compiler-helper.js","../Users/zhengqiguang/Work/github/QV/src/core/render.js","../Users/zhengqiguang/Work/github/QV/src/compiler/compiler-v2.js","../Users/zhengqiguang/Work/github/QV/src/core/event-loop.js","../Users/zhengqiguang/Work/github/QV/src/core/node.js","../Users/zhengqiguang/Work/github/QV/src/core/watcher.js","../Users/zhengqiguang/Work/github/QV/src/core/data.js","../Users/zhengqiguang/Work/github/QV/src/core/core.js","../Users/zhengqiguang/Work/github/QV/src/index.js"],"sourcesContent":["/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nexport default {\n    s(selector = \"\"){ //单个\n        return document.querySelector(selector);\n    },\n    m(selector = \"\"){// 集合\n        return document.querySelectorAll(selector);\n    },\n    id(id = \"\"){\n        return document.getElementById(id);\n    }\n\n}\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\n\nconst For = {\n    name: \"for\",\n    general(el){\n\n\n    }\n};\n\nexport default For;\n\n\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nimport _for from \"./for\";\n\nvar dsl_prefix = \"dsl-\";\n\nconst dslMap = {\n    \"dsl-if\": 1\n\n};\n\nclass DSL {\n    constructor() {\n        this.initAll();\n    }\n\n    initAll() {\n        dslMap[`${dsl_prefix}${_for.name}`] = _for;\n    }\n\n    get dslMap() {\n        return dslMap;\n    }\n}\n\n\nexport default new DSL();\n","var attrRE = /([:\\w-]+)|['\"]{1}([^'\"]*)['\"]{1}/g;\n\n// create optimized lookup object for\n// void elements as listed here:\n// http://www.w3.org/html/wg/drafts/html/master/syntax.html#void-elements\n\nimport dsl from \"../../dsl/index\";\n\nvar lookup = (Object.create) ? Object.create(null) : {};\nlookup.area = true;\nlookup.base = true;\nlookup.br = true;\nlookup.col = true;\nlookup.embed = true;\nlookup.hr = true;\nlookup.img = true;\nlookup.input = true;\nlookup.keygen = true;\nlookup.link = true;\nlookup.menuitem = true;\nlookup.meta = true;\nlookup.param = true;\nlookup.source = true;\nlookup.track = true;\nlookup.wbr = true;\n\nexport default function (tag) {\n    var i = 0;\n    var key;\n    var res = {\n        type: 'tag',\n        name: '',\n        voidElement: false,\n        attrs: {},\n        children: [],\n        dsl: []\n    };\n\n    tag.replace(attrRE, function (match) {\n\n        if (dsl.dslMap[match]) {\n           res.dsl.push(match);\n        }\n\n        if (i % 2) {\n            key = match;\n        } else {\n            if (i === 0) {\n                if (lookup[match] || tag.charAt(tag.length - 2) === '/') {\n                    res.voidElement = true;\n                }\n                res.name = match;\n            } else {\n                res.attrs[key] = match.replace(/['\"]/g, '');\n            }\n        }\n        i++;\n    });\n\n    return res;\n};","/**\n * Created by zhengqiguang on 2017/6/15.\n */\nvar tagRE = /<(?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])+>/g;\n\nimport parseTag from \"./parse-tag\";\n\nvar empty = Object.create ? Object.create(null) : {};\n\nexport default function (html, options) {\n    options || (options = {});\n    options.components || (options.components = empty);\n    var result = [];\n    var current;\n    var level = -1;\n    var arr = [];\n    var byTag = {};\n    var inComponent = false;\n\n    html.replace(tagRE, function (tag, index) {\n        if (inComponent) {\n            if (tag !== ('</' + current.name + '>')) {\n                return;\n            } else {\n                inComponent = false;\n            }\n        }\n        var isOpen = tag.charAt(1) !== '/';\n        var start = index + tag.length;\n        var nextChar = html.charAt(start);\n        var parent;\n\n        if (isOpen) {\n            level++;\n\n            current = parseTag(tag);\n            if (current.type === 'tag' && options.components[current.name]) {\n                current.type = 'component';\n                inComponent = true;\n            }\n\n            if (!current.voidElement && !inComponent && nextChar && nextChar !== '<') {\n                current.children.push({\n                    type: 'text',\n                    content: html.slice(start, html.indexOf('<', start)),\n                    parent: current\n                });\n            }\n\n            byTag[current.tagName] = current;\n\n            // if we're at root, push new base node\n            if (level === 0) {\n                result.push(current);\n            }\n\n            parent = arr[level - 1];\n\n            if (parent) {\n                current.prev = parent.children[parent.children.length - 1]\n                parent.children[parent.children.length - 1].next = current;\n                parent.children.push(current);\n                current.parent = parent;\n            }\n\n            arr[level] = current;\n        }\n\n        if (!isOpen || current.voidElement) {\n            level--;\n            if (!inComponent && nextChar !== '<' && nextChar) {\n                // trailing text node\n                arr[level].children.push({\n                    type: 'text',\n                    content: html.slice(start, html.indexOf('<', start)),\n                    parent: arr[level]\n                });\n            }\n        }\n    });\n\n    return result;\n};","/**\n * Created by zhengqiguang on 2017/6/15.\n * 修改 by  https://github.com/HenrikJoreteg/html-parse-stringify/\n */\nimport parse from \"./parse\";\nimport stringify from \"./stringify\";\n\nexport {parse, stringify};\n\n","/**\n * Created by zhengqiguang on 2017/6/21.\n */\n\nconst compiler_helper = {\n    _c(tagName, attrs = {}, children = []){\n\n        let $t = document.createElement(tagName);\n\n        for (let key in attrs) {\n            $t.setAttribute(key, attrs[key]);\n        }\n\n        for (let i = 0, n; n = children[i]; i++) {\n            $t.appendChild(n.value);\n        }\n\n        return {\n            type: \"tag\",\n            value: $t\n        };\n    },\n    _i(data, itemName, renderIfFn){\n        if (data[itemName]) {\n            return renderIfFn();\n        } else {\n            return {\n                type: \"fragment\",\n                value: document.createDocumentFragment()\n            }\n        }\n    },\n    _f(data, itemName, keyName, renderEachFn){\n\n        let $t = document.createDocumentFragment();\n\n        for (let item in data[itemName]) {\n            data[keyName] = data[itemName][item];\n\n            $t.appendChild(renderEachFn(data).value);\n        }\n\n        delete data[keyName];\n\n        return {\n            type: \"fragment\",\n            value: $t\n        };\n\n    },\n    _t(fn, data){\n\n        let temp = fn(data);\n\n        return {\n            type: \"text\",\n            value: document.createTextNode(temp)\n        };\n    },\n\n    generaltplFn($ast){\n\n        let linkArgs = [];\n        let $temp = this.generalNode($ast, linkArgs),\n\n            $tempFn = `with(that){return ${$temp}}`;\n\n\n        let tplFn = new Function(\"that\", `${$tempFn}`);\n\n        return {\n            tplFn: tplFn,\n            linkArgs: linkArgs\n        };\n\n    },\n    generalNode($node, linkArgs){\n\n        if ($node.dsl && $node.dsl.length) { //存在 dsl\n            //dsl 优先级 if > for\n            let $sdlTemp = \"\";\n            let dslIndex;\n            if ((dslIndex = $node.dsl.indexOf(\"dsl-if\")) !== -1) { //先判断 if 语句\n                let itemName = $node.attrs[\"dsl-if\"];//现在只判断了值，没有进行表达式判断\n\n                linkArgs.push(itemName);\n\n                $node.dsl.splice(dslIndex, 1);\n                delete $node.attrs[\"dsl-if\"];\n\n\n                return `_i(data,'${itemName}',function(){\n                    return ${this.generalNode($node, linkArgs)} \n                })`\n\n\n            } else if ((dslIndex = $node.dsl.indexOf(\"dsl-for\")) !== -1) { //\n                let reg = /([\\w\\W]*?) in ([\\w\\W].?)/,\n                    result = $node.attrs[\"dsl-for\"].match(reg);\n\n                linkArgs.push(result[2]);\n\n                $node.dsl.splice(dslIndex, 1);\n                delete $node.attrs[\"dsl-for\"];\n\n                return `_f(data,'${result[2]}','${result[1]}',function(data){\n                    return ${this.generalNode($node, linkArgs)} ;\n                })`\n\n            }\n\n\n        } else if ($node.type === \"tag\") {\n            return `_c('${$node.name}', ${JSON.stringify($node.attrs)},[${$node.children.map(item => {\n                return this.generalNode(item, linkArgs)\n            })}])`\n\n        } else if ($node.type === \"text\") {\n            $node.content = $node.content.replace(/\\n/g, \"\");\n            let text = $node.content.trim();\n\n            let patt = /{{[ \\t]*([\\w\\W]*?)[ \\t]*}}/g;\n\n            let result = \"\",\n                temp = \"\",\n                cursor = 0;\n\n            while ((result = patt.exec(text)) !== null) {\n                let $temp1 = text.slice(cursor, result.index); //模板前面\n                cursor += $temp1.length;\n\n                temp += this.wrapStaticBlock($temp1);\n\n                temp += this.wrapDynamicBlock(result);\n\n                linkArgs.push(result[1]);\n\n                cursor += result[0].length;\n            }\n\n\n            temp += this.wrapStaticBlock(text.slice(cursor, text.length));\n\n            let fn = this.gTplFn(temp);\n\n            return `_t(${fn.toString()},data)`\n        }\n\n\n    },\n    wrapStaticBlock(str) {\n\n        return \"\\'\" + str + \"\\'\";\n\n    },\n    wrapDynamicBlock (result) {\n\n        return \" + data.\" + result[1] + \" + \"\n    },\n    gTplFn: function (str) {\n\n        let $t = \" return \" + str;\n\n        $t = $t.replace(/\\n/g, \"\");\n\n        let $tempFn = new Function(\"data\", $t);\n\n        return $tempFn;\n\n    }\n\n}\n\nexport default compiler_helper;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\nimport compiler_helper from \"../compiler/compiler-helper\";\n\nconst render = {\n\n    mount($node, $data){\n\n        compiler_helper.data = $data;\n\n        let $newDom = this.generalDom($node.$tplfn(compiler_helper));\n\n        this.replaceNode($newDom, $node);\n\n    },\n\n    generalDom(domStr){\n\n        if (domStr instanceof Object) {\n            return domStr.value;\n        }\n\n        var $temp = document.createElement(\"div\");\n        $temp.innerHTML = domStr.trim(); //不然会有多余的空格等东西\n        return $temp.childNodes[0];\n    },\n\n    replaceNode(newDom, node){\n        let $el = node.$el;\n\n        $el.parentNode.replaceChild(newDom, $el);\n\n        node.$el = newDom;\n    }\n\n\n}\n\n\nexport default render;","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\nimport {parse as htmlParse, stringify as htmlStringify} from \"./ast/index\";\n\nimport Render from \"../core/render\";\n\nimport compiler_helper from \"./compiler-helper\";\n\nclass Compiler {\n\n\n    constructor(tpl) {\n        this.$tpl = Render.generalDom(tpl);\n        this.tpl = this.$tpl.outerHTML;\n        this.$ast = htmlParse(tpl);\n\n        // console.log(this.$ast[0]);\n\n        // compiler_helper.generaltplFn(this.$ast[0]);\n\n\n        // console.log(htmlStringify(this.$ast));\n\n        this.init(compiler_helper.generaltplFn(this.$ast[0]));\n\n    }\n\n\n    init({tplFn, linkArgs}) {\n        this.tplFn = tplFn;\n        this.linkArgs = linkArgs;\n    }\n\n    rebuild() {\n\n\n    }\n\n}\n\n\nexport default Compiler;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\n\nlet EventLoop = {\n    d_o(fn){\n        let p = Promise.resolve();\n        p.then(fn).catch((e) => {\n            console.log(e);\n        });\n    }\n\n}\n\nexport default EventLoop;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nimport selector from  \"../common/selector\";\n\nimport Compiler from \"../compiler/compiler-v2\";\n\nimport Render  from \"./render\";\n\nimport EventLoop from \"./event-loop\";\n\n\nclass Node {\n\n    constructor({el, template, data}) {\n        this.$data = data;\n        this.el = el;\n        this.template = template;\n        this.$el = selector.s(this.el);\n\n        let $t = selector.s(this.template);\n        if ($t) {\n            this.$template = $t.innerHTML.trim();\n        } else {\n            //error\n        }\n        this.$compiler = new Compiler(this.$template);\n\n        this.$args = this.$compiler.linkArgs;\n        this.$tplfn = this.$compiler.tplFn;\n    }\n\n    update() {\n        EventLoop.d_o(Render.mount.bind(Render, this, this.$data));\n    }\n\n}\n\nexport default Node;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nclass Watcher {\n    constructor(data) {\n        this.$data = data;\n        this.mountWatcher();\n\n    }\n\n    mountWatcher() {\n\n        let od = this.$data[\"_od_\"];\n\n        for (let key in this.$data) {\n\n            (function (key) {\n\n                let timeoutHandler = null;\n\n                if (key !== \"_od_\" && !od[key].mounted) {\n                    if (!od[key]) {\n                        throw new Error(`data:${key} is init `);\n                    }\n                    Object.defineProperty(this.$data, key, {\n                        get () {\n                            return od[key].value;\n                        },\n                        set(value) {\n                            clearTimeout(timeoutHandler);\n                            setTimeout(() => {\n                                if (value !== od[key].value) {\n                                    var $n = od[key].linkNodes;\n                                    od[key].value = value;\n                                    for (var i = 0, n; n = $n[i]; i++) {\n                                        n.update();\n                                    }\n                                }\n                            }, 1000 / 60);//一帧节流\n\n                        }\n                    });\n                    od[key].mounted = true;\n                }\n            }.bind(this))(key);\n\n        }\n    }\n\n    linkNode($node) {\n\n\n        for (let i = 0, n; n = $node.$args[i]; i++) {\n            if (this.$data[n] !== undefined &&\n                this.$data[\"_od_\"][n] !== undefined &&\n                this.$data[\"_od_\"][n].linkNodes.indexOf($node) === -1) {\n                this.$data[\"_od_\"][n].linkNodes.push($node);\n            }\n        }\n    }\n\n\n    updateData() {\n\n\n    }\n\n\n}\n\n\nexport default Watcher;\n","/**\n * Created by zhengqiguang on 2017/6/15.\n */\n\nconst helper = {\n    insertOD($targetData, $data){\n\n        !$targetData && ($targetData = {});\n\n        for (var key in $data) {\n            $targetData[key] = {\n                value: $data[key],\n                linkNodes: [],\n                mounted: false\n            }\n        }\n\n        return $targetData;\n\n    }\n\n\n}\n\nclass Data {\n\n    static formatData(data = {}) {\n        data[\"_od_\"] = helper.insertOD(data[\"_od_\"], data);\n        return data;\n    }\n\n\n}\n\nexport default Data;\n","/**\n * Created by zhengqiguang on 2017/6/14.\n */\n\nimport Node from \"./node\";\nimport Watcher from \"./watcher\";\nimport Data from \"./data\";\nimport render from \"./render\";\n\nclass QV {\n    constructor(opt = {}) {\n        this._$opt = opt;\n\n        this.formatOption(opt);\n\n        this.mountRoot();\n\n    }\n\n    formatOption(opt) {\n\n        this.$data = Data.formatData(opt.data);\n\n        this.$root = new Node(opt);\n\n        this.$watcher = new Watcher(this.$data);\n\n        this.$watcher.linkNode(this.$root);\n\n    }\n\n    mountRoot() {\n        render.mount(this.$root, this.$data);\n    }\n\n\n}\n\n\nexport  default QV;\n","/**\n * Created by zhengqiguang on 2017/6/14.\n */\n\n\nimport Core from \"./core/core\";\n\n\n\nexport default Core;\n"],"names":["selector","document","querySelector","querySelectorAll","id","getElementById","For","el","dsl_prefix","dslMap","DSL","initAll","_for","name","attrRE","lookup","Object","create","area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","tag","i","key","res","replace","match","dsl","push","charAt","length","voidElement","attrs","tagRE","empty","html","options","components","result","current","level","arr","byTag","inComponent","index","isOpen","start","nextChar","parent","parseTag","type","children","slice","indexOf","tagName","prev","next","compiler_helper","$t","createElement","setAttribute","n","appendChild","value","data","itemName","renderIfFn","createDocumentFragment","keyName","renderEachFn","item","fn","temp","createTextNode","$ast","linkArgs","$temp","generalNode","$tempFn","tplFn","Function","$node","$sdlTemp","dslIndex","splice","reg","JSON","stringify","map","content","text","trim","patt","cursor","exec","$temp1","wrapStaticBlock","wrapDynamicBlock","gTplFn","toString","str","render","$data","$newDom","generalDom","$tplfn","replaceNode","domStr","innerHTML","childNodes","newDom","node","$el","parentNode","replaceChild","Compiler","tpl","$tpl","Render","outerHTML","htmlParse","init","generaltplFn","EventLoop","p","Promise","resolve","then","catch","e","log","Node","template","s","$template","$compiler","$args","d_o","mount","bind","Watcher","mountWatcher","od","timeoutHandler","mounted","Error","defineProperty","$n","linkNodes","update","undefined","helper","$targetData","Data","insertOD","QV","opt","_$opt","formatOption","mountRoot","formatData","$root","$watcher","linkNode"],"mappings":"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"}